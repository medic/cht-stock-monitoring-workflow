<?xml version="1.0"?>
<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:jr="http://openrosa.org/javarosa" xmlns:orx="http://openrosa.org/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <h:head>
    <h:title>Edit Village</h:title>
    <model>
      <itext>
        <translation lang="en">
          <text id="/data/c70_village/contact/select_c12:label">
            <value>Select Person</value>
          </text>
          <text id="/data/c70_village/contact/select_c72:label">
            <value>Select Person</value>
          </text>
          <text id="/data/c70_village/contact/select_c82:label">
            <value>Select Person</value>
          </text>
          <text id="/data/c70_village/contact/select_c92:label">
            <value>Select Person</value>
          </text>
          <text id="/data/c70_village/family_geolocation:hint">
            <value>-</value>
          </text>
          <text id="/data/c70_village/family_geolocation:label">
            <value>Geolocation of the family 
Click on this point only when you are in the family</value>
          </text>
          <text id="/data/c70_village/family_number:jr:constraintMsg">
            <value>Should be between 1 and 50</value>
          </text>
          <text id="/data/c70_village/family_number:label">
            <value>Number of household(s) in the compound</value>
          </text>
          <text id="/data/c70_village/name:jr:constraintMsg">
            <value>You can not edit this form. Please cancel.</value>
          </text>
          <text id="/data/c70_village/name:label">
            <value><output value=" /data/init/place_name_label "/></value>
          </text>
          <text id="/data/c70_village/out_chw_area/false:label">
            <value>No</value>
          </text>
          <text id="/data/c70_village/out_chw_area/true:label">
            <value>Yes</value>
          </text>
          <text id="/data/c70_village/out_chw_area:label">
            <value>Out of CHW Area ?</value>
          </text>
          <text id="/data/init/change_primary/false:label">
            <value>No</value>
          </text>
          <text id="/data/init/change_primary/true:label">
            <value>Yes</value>
          </text>
          <text id="/data/init/change_primary:label">
            <value>Do you want to change the primary contact?</value>
          </text>
          <text id="/data/init/contact_name_note:label">
            <value>Primary contact: <output value=" /data/c70_village/contact/contact_name "/></value>
          </text>
          <text id="/data/init/place_name_selector/c10_central:label">
            <value>Name of the central</value>
          </text>
          <text id="/data/init/place_name_selector/c70_village:label">
            <value>Name of the village</value>
          </text>
          <text id="/data/init/place_name_selector/c80_concession:label">
            <value>Name of the concession</value>
          </text>
          <text id="/data/init/place_name_selector/c90_household:label">
            <value>Name of the household</value>
          </text>
          <text id="/data/init/place_type/c10_central:label">
            <value>Central</value>
          </text>
          <text id="/data/init/place_type/c70_village:label">
            <value>Village</value>
          </text>
          <text id="/data/init/place_type/c80_concession:label">
            <value>Concession</value>
          </text>
          <text id="/data/init/place_type/c90_household:label">
            <value>Household</value>
          </text>
          <text id="/data/init/user_contact/n_edit:label">
            <value>&lt;span style="color:red;"&gt;You can not edit this form. Please cancel.&lt;/span&gt;</value>
          </text>
        </translation>
        <translation lang="fr">
          <text id="/data/c70_village/contact/select_c12:label">
            <value>Choisisser le contact primaire</value>
          </text>
          <text id="/data/c70_village/contact/select_c72:label">
            <value>Choisisser le contact primaire</value>
          </text>
          <text id="/data/c70_village/contact/select_c82:label">
            <value>Choisisser le contact primaire</value>
          </text>
          <text id="/data/c70_village/contact/select_c92:label">
            <value>Choisisser le contact primaire</value>
          </text>
          <text id="/data/c70_village/family_geolocation:hint">
            <value>Click on this point only when you are in the concession.</value>
          </text>
          <text id="/data/c70_village/family_geolocation:label">
            <value>Géolocalisation de la concession 
Cliquez sur ce point seulement lorsque vous êtes dans la concession</value>
          </text>
          <text id="/data/c70_village/family_number:jr:constraintMsg">
            <value>Doit être compris entre 1 et 50</value>
          </text>
          <text id="/data/c70_village/family_number:label">
            <value>Nombre de ménage (s) dans la concession:</value>
          </text>
          <text id="/data/c70_village/meta/created_by:label">
            <value>-</value>
          </text>
          <text id="/data/c70_village/meta/created_by_person_uuid:label">
            <value>-</value>
          </text>
          <text id="/data/c70_village/meta/created_by_place_uuid:label">
            <value>-</value>
          </text>
          <text id="/data/c70_village/meta:label">
            <value>-</value>
          </text>
          <text id="/data/c70_village/name:jr:constraintMsg">
            <value>Vous ne pouvez pas modifier ce formulaire. Veuillez annuler.</value>
          </text>
          <text id="/data/c70_village/name:label">
            <value><output value=" /data/init/place_name_label "/></value>
          </text>
          <text id="/data/c70_village/out_chw_area/false:label">
            <value>Non</value>
          </text>
          <text id="/data/c70_village/out_chw_area/true:label">
            <value>Oui</value>
          </text>
          <text id="/data/c70_village/out_chw_area:label">
            <value>Hors zone ASC ?</value>
          </text>
          <text id="/data/c70_village/parent:label">
            <value>-</value>
          </text>
          <text id="/data/c70_village/type:label">
            <value>-</value>
          </text>
          <text id="/data/c70_village:label">
            <value>-</value>
          </text>
          <text id="/data/init/change_primary/false:label">
            <value>Non</value>
          </text>
          <text id="/data/init/change_primary/true:label">
            <value>Oui</value>
          </text>
          <text id="/data/init/change_primary:label">
            <value>Voulez-vous changer le contact primaire?</value>
          </text>
          <text id="/data/init/contact_name_note:label">
            <value>Contact primaire: <output value=" /data/c70_village/contact/contact_name "/></value>
          </text>
          <text id="/data/init/place_name_selector/c10_central:label">
            <value>Nom du central</value>
          </text>
          <text id="/data/init/place_name_selector/c70_village:label">
            <value>Nom du village</value>
          </text>
          <text id="/data/init/place_name_selector/c80_concession:label">
            <value>Nom de la concession</value>
          </text>
          <text id="/data/init/place_name_selector/c90_household:label">
            <value>Nom du ménage</value>
          </text>
          <text id="/data/init/place_type/c10_central:label">
            <value>Central</value>
          </text>
          <text id="/data/init/place_type/c70_village:label">
            <value>Village</value>
          </text>
          <text id="/data/init/place_type/c80_concession:label">
            <value>Concession</value>
          </text>
          <text id="/data/init/place_type/c90_household:label">
            <value>Famille</value>
          </text>
          <text id="/data/init/user_contact/n_edit:label">
            <value>&lt;span style="color:red;"&gt;Vous ne pouvez pas modifier ce formulaire. Veuillez annuler.&lt;/span&gt;</value>
          </text>
          <text id="/data/inputs/user/contact_id:label">
            <value>-</value>
          </text>
          <text id="/data/inputs/user/facility_id:label">
            <value>-</value>
          </text>
          <text id="/data/inputs/user/name:label">
            <value>-</value>
          </text>
          <text id="/data/inputs/user:label">
            <value>-</value>
          </text>
          <text id="/data/inputs:label">
            <value>-</value>
          </text>
        </translation>
      </itext>
      <instance>
        <data id="contact:c70_village:edit" prefix="J1!contact:c70_village:edit!" delimiter="#" version="2023-11-28  16-53">
          <inputs>
            <meta>
              <location>
                <lat/>
                <long/>
                <error/>
                <message/>
              </location>
            </meta>
            <user>
              <contact_id/>
              <facility_id/>
              <name/>
            </user>
          </inputs>
          <c70_village>
            <parent/>
            <type/>
            <contact>
              <name/>
              <contact_name/>
              <select_c12/>
              <select_c72/>
              <select_c82/>
              <select_c92/>
              <_id/>
            </contact>
            <name/>
            <geolocation/>
            <out_chw_area/>
            <family_number/>
            <family_geolocation>Cliquez sur ce point seulement lorsque vous êtes dans la concession</family_geolocation>
            <meta tag="hidden">
              <created_by/>
              <created_by_person_uuid/>
              <created_by_place_uuid/>
              <last_edited_by/>
              <last_edited_by_person_uuid/>
              <last_edited_by_place_uuid/>
            </meta>
          </c70_village>
          <init>
            <place_type/>
            <place_name_selector>c70_village</place_name_selector>
            <place_name_label/>
            <user_contact>
              <contact_uuid/>
              <role/>
              <user_role/>
              <n_edit/>
            </user_contact>
            <contact_name_note/>
            <change_primary/>
            <primary_contact/>
            <primary_contact_name/>
          </init>
          <meta tag="hidden">
            <instanceID/>
          </meta>
        </data>
      </instance>
      <bind nodeset="/data/inputs" relevant="0"/>
      <bind nodeset="/data/inputs/user/contact_id" type="string"/>
      <bind nodeset="/data/inputs/user/facility_id" type="string"/>
      <bind nodeset="/data/inputs/user/name" type="string"/>
      <bind calculate="&quot;c70_village&quot;" nodeset="/data/init/place_type" type="select1"/>
      <bind nodeset="/data/init/place_name_selector" type="select1"/>
      <bind calculate="jr:choice-name( /data/init/place_name_selector ,' /data/init/place_name_selector ')" nodeset="/data/init/place_name_label" type="string"/>
      <bind calculate=" /data/inputs/user/contact_id " nodeset="/data/init/user_contact/contact_uuid" readonly="true()" type="string"/>
      <bind nodeset="/data/init/user_contact/role" type="string"/>
      <bind calculate="../role" nodeset="/data/init/user_contact/user_role" type="string"/>
      <bind nodeset="/data/init/user_contact/n_edit" readonly="true()" relevant=" /data/init/user_contact/user_role  = 'oca'" type="string"/>
      <bind nodeset="/data/init/contact_name_note" readonly="true()" type="string"/>
      <bind nodeset="/data/init/change_primary" type="select1"/>
      <bind calculate="if( /data/init/change_primary  = '', ../../c70_village/contact/_id, .)" nodeset="/data/init/primary_contact" type="string"/>
      <bind calculate="if( /data/init/change_primary  = '', ../../c70_village/contact/name, .)" nodeset="/data/init/primary_contact_name" type="string"/>
      <bind nodeset="/data/c70_village/parent" readonly="true()" type="string"/>
      <bind nodeset="/data/c70_village/type" readonly="true()" type="string"/>
      <bind nodeset="/data/c70_village/contact/name" readonly="true()" type="string"/>
      <bind calculate="../name" nodeset="/data/c70_village/contact/contact_name" type="string"/>
      <bind nodeset="/data/c70_village/contact/select_c12" relevant=" /data/init/change_primary  = 'true' and  /data/init/place_type  = 'c10_central'" required="true()" type="string"/>
      <bind nodeset="/data/c70_village/contact/select_c72" relevant=" /data/init/change_primary  = 'true' and  /data/init/place_type  = 'c70_village'" required="true()" type="string"/>
      <bind nodeset="/data/c70_village/contact/select_c82" relevant=" /data/init/change_primary  = 'true' and  /data/init/place_type  = 'c80_concession'" required="true()" type="string"/>
      <bind nodeset="/data/c70_village/contact/select_c92" relevant=" /data/init/change_primary  = 'true' and  /data/init/place_type  = 'c90_household'" required="true()" type="string"/>
      <bind calculate="if( /data/init/change_primary  = 'true',
coalesce(
../select_c12,
../select_c72,
../select_c82,
../select_c92
),  /data/init/primary_contact )"/>
      <bind nodeset="/data/c70_village/name" type="string" required="true()" constraint=" /data/init/user_contact/user_role  != 'oca'" jr:constraintMsg="jr:itext('/data/c70_village/name:jr:constraintMsg')"/>
      <bind nodeset="/data/c70_village/geolocation" type="string" calculate="concat(../../inputs/meta/location/lat, concat(' ', ../../inputs/meta/location/long))"/>
      <bind nodeset="/data/c70_village/out_chw_area" type="select1" relevant=" /data/init/place_type  = 'c70_village'" required="true()"/>
      <bind nodeset="/data/c70_village/family_number" type="int" required="true()" constraint=". &gt;= 1 and . &lt;= 50" jr:constraintMsg="jr:itext('/data/c70_village/family_number:jr:constraintMsg')" relevant=" /data/init/place_type  = 'c80_concession'"/>
      <bind nodeset="/data/c70_village/family_geolocation" type="geopoint" relevant=" /data/init/place_type  = 'c80_concession'"/>
      <bind nodeset="/data/c70_village/meta/created_by" type="string" readonly="true()"/>
      <bind nodeset="/data/c70_village/meta/created_by_person_uuid" type="string" readonly="true()"/>
      <bind nodeset="/data/c70_village/meta/created_by_place_uuid" type="string"/>
      <bind calculate="../../../inputs/user/name" nodeset="/data/c70_village/meta/last_edited_by" type="string"/>
      <bind calculate="../../../inputs/user/contact_id" nodeset="/data/c70_village/meta/last_edited_by_person_uuid" type="string"/>
      <bind calculate="../../../inputs/user/facility_id" nodeset="/data/c70_village/meta/last_edited_by_place_uuid" type="string"/>
      <bind calculate="concat('uuid:', uuid())" nodeset="/data/meta/instanceID" readonly="true()" type="string"/>
    </model>
  </h:head>
  <h:body>
    <group ref="/data/inputs">
      <group ref="/data/inputs/user">
        <input ref="/data/inputs/user/contact_id"/>
        <input ref="/data/inputs/user/facility_id"/>
        <input ref="/data/inputs/user/name"/>
      </group>
    </group>
    <group appearance="field-list" ref="/data/init">
      <select1 appearance="hidden" ref="/data/init/place_type">
        <item>
          <label ref="jr:itext('/data/init/place_type/c10_central:label')"/>
          <value>c10_central</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/place_type/c70_village:label')"/>
          <value>c70_village</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/place_type/c80_concession:label')"/>
          <value>c80_concession</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/place_type/c90_household:label')"/>
          <value>c90_household</value>
        </item>
      </select1>
      <select1 appearance="hidden" ref="/data/init/place_name_selector">
        <item>
          <label ref="jr:itext('/data/init/place_name_selector/c10_central:label')"/>
          <value>c10_central</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/place_name_selector/c70_village:label')"/>
          <value>c70_village</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/place_name_selector/c80_concession:label')"/>
          <value>c80_concession</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/place_name_selector/c90_household:label')"/>
          <value>c90_household</value>
        </item>
      </select1>
      <group ref="/data/init/user_contact">
        <input appearance="db-object hidden" ref="/data/init/user_contact/contact_uuid"/>
        <input ref="/data/init/user_contact/n_edit">
          <label ref="jr:itext('/data/init/user_contact/n_edit:label')"/>
        </input>
      </group>
      <input ref="/data/init/contact_name_note">
        <label ref="jr:itext('/data/init/contact_name_note:label')"/>
      </input>
      <select1 ref="/data/init/change_primary">
        <label ref="jr:itext('/data/init/change_primary:label')"/>
        <item>
          <label ref="jr:itext('/data/init/change_primary/true:label')"/>
          <value>true</value>
        </item>
        <item>
          <label ref="jr:itext('/data/init/change_primary/false:label')"/>
          <value>false</value>
        </item>
      </select1>
    </group>
    <group appearance="field-list" ref="/data/c70_village">
      <group ref="/data/c70_village/contact">
        <input appearance="select-contact type-c12_central" ref="/data/c70_village/contact/select_c12">
          <label ref="jr:itext('/data/c70_village/contact/select_c12:label')"/>
        </input>
        <input appearance="select-contact type-c72_village" ref="/data/c70_village/contact/select_c72">
          <label ref="jr:itext('/data/c70_village/contact/select_c72:label')"/>
        </input>
        <input appearance="select-contact type-c82_concession" ref="/data/c70_village/contact/select_c82">
          <label ref="jr:itext('/data/c70_village/contact/select_c82:label')"/>
        </input>
        <input appearance="select-contact type-c92_household" ref="/data/c70_village/contact/select_c92">
          <label ref="jr:itext('/data/c70_village/contact/select_c92:label')"/>
        </input>
      </group>
      <input ref="/data/c70_village/name">
        <label ref="jr:itext('/data/c70_village/name:label')"/>
      </input>
      <select1 appearance="horizontal" ref="/data/c70_village/out_chw_area">
        <label ref="jr:itext('/data/c70_village/out_chw_area:label')"/>
        <item>
          <label ref="jr:itext('/data/c70_village/out_chw_area/true:label')"/>
          <value>true</value>
        </item>
        <item>
          <label ref="jr:itext('/data/c70_village/out_chw_area/false:label')"/>
          <value>false</value>
        </item>
      </select1>
      <input ref="/data/c70_village/family_number">
        <label ref="jr:itext('/data/c70_village/family_number:label')"/>
      </input>
      <input ref="/data/c70_village/family_geolocation">
        <label ref="jr:itext('/data/c70_village/family_geolocation:label')"/>
        <hint ref="jr:itext('/data/c70_village/family_geolocation:hint')"/>
      </input>
      <group appearance="hidden" ref="/data/c70_village/meta"/>
    </group>
  </h:body>
</h:html>
